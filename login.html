<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Venn â€¢ Log In</title>
    <!-- Supabase config placeholders: fill these with your project values -->
    <meta name="supabase-url" content="YOUR_SUPABASE_URL" />
    <meta name="supabase-anon-key" content="YOUR_SUPABASE_ANON_KEY" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <!-- Supabase JS (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
      .auth {
        min-height: 100vh;
        display: grid;
        place-items: center;
        padding: 3rem 1rem;
      }
      .auth__card {
        width: min(520px, 92vw);
        background: var(--panel);
        border: 1px solid var(--border);
        border-radius: 18px;
        box-shadow: 0 28px 70px var(--shadow-ambient);
        padding: clamp(1.25rem, 4vw, 2rem);
      }
      .auth__title {
        font-size: clamp(1.4rem, 3.6vw, 1.9rem);
        letter-spacing: -0.01em;
        margin: 0 0 0.5rem;
      }
      .auth__subtitle {
        color: var(--muted);
        margin: 0 0 1.25rem;
      }
      .auth__form {
        display: grid;
        gap: 0.9rem;
      }
      .auth__form label {
        font-size: 0.8rem;
        letter-spacing: 0.18em;
        text-transform: uppercase;
        color: var(--eyebrow);
      }
      .auth__form input[type="email"],
      .auth__form input[type="password"] {
        width: 100%;
        appearance: none;
        border: 1px solid var(--border);
        border-radius: 12px;
        background: var(--panel);
        color: var(--fg);
        padding: 0.7rem 0.9rem;
        font-size: 1rem;
        outline: none;
        transition: border-color 180ms ease, box-shadow 180ms ease;
      }
      .auth__form input:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 3px var(--accent-soft);
      }
      .auth__meta {
        margin-top: 0.5rem;
        color: var(--muted);
      }
      .auth__actions {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 0.75rem;
        margin-top: 0.5rem;
      }
      .auth__links {
        display: flex;
        gap: 1rem;
        font-size: 0.9rem;
      }
      .auth__links a { color: var(--category-fg); }
    </style>
  </head>
  <body class="theme-radiant">
    <main class="auth">
      <div class="auth__card" role="dialog" aria-labelledby="auth-title">
        <h1 class="auth__title" id="auth-title">Log in to Venn</h1>
        <p class="auth__subtitle">Welcome back. Enter your credentials to continue.</p>
        <form class="auth__form" id="auth-form" autocomplete="off">
          <div>
            <label for="email">Email</label>
            <input id="email" type="email" name="email" placeholder="you@company.com" required />
          </div>
          <div class="auth__actions">
            <button class="cta" id="email-otp" type="submit">Send Magic Link</button>
            <div class="auth__links">
              <a href="#">Forgot password?</a>
              <a href="index.html" class="btn">Back</a>
            </div>
          </div>
          <p class="auth__meta" id="status">No account? <a href="#">Request access</a></p>
        </form>
      </div>
    </main>
    <script>
      (function () {
        const url = document.querySelector('meta[name="supabase-url"]').content;
        const key = document.querySelector('meta[name="supabase-anon-key"]').content;
        const sb = (window.supabase && url && key) ? window.supabase.createClient(url, key) : null;

        const form = document.getElementById('auth-form');
        const emailInput = document.getElementById('email');
        const statusEl = document.getElementById('status');

        async function init() {
          if (!sb) return;
          const { data } = await sb.auth.getSession();
          if (data?.session) window.location.href = 'index.html';
        }

        form?.addEventListener('submit', async (e) => {
          e.preventDefault();
          if (!sb) { statusEl.textContent = 'Supabase not configured.'; return; }
          const email = (emailInput?.value || '').trim();
          if (!email) return;
          const { error } = await sb.auth.signInWithOtp({ email, options: { emailRedirectTo: window.location.origin + '/index.html' } });
          statusEl.textContent = error ? 'Failed to send link.' : 'Check your email for a login link.';
        });

        init();
      })();
    </script>
  </body>
  </html>
